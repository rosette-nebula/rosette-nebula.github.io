<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>cookies、session、localStorage、indexDB | 小达学徒</title>
    <meta name="description" content="小达学徒 - 专注于前端道路">
    <link rel="stylesheet" href="/assets/style.b73d722d.css">
    <link rel="modulepreload" href="/assets/app.32bb6aff.js">
    <link rel="modulepreload" href="/assets/books_n-01-前端笔记_s-02-浏览器_01-cookies、session、localstorage.md.2e1b206c.lean.js">
    
    <link rel="icon" href="/favicon.ico">
  <meta name="twitter:title" content="cookies、session、localStorage、indexDB | 小达学徒">
  <meta property="og:title" content="cookies、session、localStorage、indexDB | 小达学徒">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme"><header class="nav-bar" data-v-675d8756><div class="sidebar-button" data-v-675d8756><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div><a class="nav-bar-title" href="/" aria-label="小达学徒, back to home" data-v-675d8756 data-v-cc01ef16><img class="logo" src="/avatar.jpg" alt="Logo" data-v-cc01ef16> 小达学徒</a><div class="flex-grow" data-v-675d8756></div><div class="nav" data-v-675d8756><nav class="nav-links" data-v-675d8756 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item active" href="/books/n-01-前端笔记/" data-v-b8818f8c>前端笔记 <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/books/n-02-后端/" data-v-b8818f8c>后端 <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/books/n-03-杂记/" data-v-b8818f8c>杂记 <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/books/n-04-插件/" data-v-b8818f8c>插件 <!----></a></div></div><!--]--><!----><!----></nav></div><!--[--><!--]--></header><aside class="sidebar" data-v-83e92a68><nav class="nav-links nav" data-v-83e92a68 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item active" href="/books/n-01-前端笔记/" data-v-b8818f8c>前端笔记 <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/books/n-02-后端/" data-v-b8818f8c>后端 <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/books/n-03-杂记/" data-v-b8818f8c>杂记 <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/books/n-04-插件/" data-v-b8818f8c>插件 <!----></a></div></div><!--]--><!----><!----></nav><!--[--><!--]--><ul class="sidebar-links" data-v-83e92a68><!--[--><li class="sidebar-link"><p class="sidebar-link-item">JS</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/books/n-01-前端笔记/s-01-JS/01-JS数据类型">JS数据类型</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/books/n-01-前端笔记/s-01-JS/02-类型判断">类型判断</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/books/n-01-前端笔记/s-01-JS/03-变量提升和函数提升">变量提升和函数提升</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/books/n-01-前端笔记/s-01-JS/04-js进入全屏和退出全屏">js进入全屏和退出全屏</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">浏览器</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item active" href="/books/n-01-前端笔记/s-02-浏览器/01-cookies、session、localstorage">cookies、session、localstorage</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#cookie">cookie</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#限制访问cookie，有效确保-cookie-安全传送">限制访问Cookie，有效确保 Cookie 安全传送</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#cookie-作用域">Cookie 作用域</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="#localstorage">localStorage</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#特点">特点</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#api">Api</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="#sessionstorage">sessionStorage</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#特点-1">特点</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#api-1">Api</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="#indexdb">indexDB</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#现成的类库">现成的类库</a><!----></li></ul></li></ul></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">vite</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/books/n-01-前端笔记/s-03-vite/01-vite vue 添加代码格式化、审查、git提交">vite vue 添加代码格式化、审查、git提交</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/books/n-01-前端笔记/s-03-vite/02-vite添加路径别名">vite添加路径别名</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">CSS</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/books/n-01-前端笔记/s-04-CSS/01-暗黑模式切换">暗黑模式切换</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">uniapp</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/books/n-01-前端笔记/s-05-uniapp/01-微信小程序动态获取页面title">微信小程序动态获取页面title</a><!----></li></ul></li><!--]--></ul><!--[--><!--]--></aside><div class="sidebar-mask"></div><main class="page" data-v-7eddb2c4><div class="container" data-v-7eddb2c4><!--[--><!--]--><div style="position:relative;" class="content" data-v-7eddb2c4><div><h1 id="cookies、session、localstorage、indexdb" tabindex="-1">cookies、session、localStorage、indexDB</h1><h2 id="cookie" tabindex="-1">cookie</h2><ul><li><p><code>Cookie</code>是一个HTTP请求标头。其中含有服务器通过<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Set-Cookie" target="_blank" rel="noopener noreferrer">Set-Cookie</a>设置或通过<code>JavaScript</code>的 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Document/cookie" target="_blank" rel="noopener noreferrer">Document.cookie</a>方法操作。存放到客户端。</p></li><li><p>经常由服务端设置cookie，发送到客户端(一般指浏览器)</p></li><li><p>cookie 的声明周期</p><ul><li>简单的cookie, 不设置任何的过期时间和有效期，只是在这次会话中使用。本次会话关闭后就会自动删除cookie。有些浏览器自动恢复会话功能，cookie就会一直存在。</li><li>有限期的cookie，设置过期时间（Expires）或有效期（Max-Age）。cookie会在一段时间内存活。</li></ul></li><li><p>Cookie 大小大约在 4k左右</p></li><li><p>每次浏览器发送请求，都会将之前保存的 cookie 信息通过 cookie 请求头部再发送给服务器。</p></li><li><p>同域内cookie信息共享。</p></li></ul><h3 id="限制访问cookie，有效确保-cookie-安全传送" tabindex="-1">限制访问Cookie，有效确保 Cookie 安全传送</h3><ul><li>设置<code>Secure</code>属性 <ul><li>设置为<code>Secure</code>属性的 Cookie 只能有 HTTPS 协议加密过得请求才会发送到服务端，HTTP协议不会带上Cookie</li><li>设置 <code>HttpOnly</code>属性。<code>Document.cookie</code> API就无法访问 Cookie.这样Cookie只能为服务端所用。</li></ul></li></ul><h3 id="cookie-作用域" tabindex="-1">Cookie 作用域</h3><ul><li><code>Domain</code><ul><li>指定那些域可以访问 cookie。如果设置了<code>Domain</code>，指定的域和子域都可以访问cookie。不设置<code>Domain</code>，则只有主域可以访问，子域不能访问。</li></ul></li><li><code>Path</code><ul><li>设置主机下的那些路径可以访问cookie。使用<code>%x2F</code>(&quot;/&quot;)作为路径分隔符，子路径也会被匹配。</li></ul></li><li><code>SameSite</code><ul><li>允许服务器要求某个cookie在跨站请求时不会被发送。</li><li>可选值 <ul><li><code>None</code>: 浏览器会在同站、跨站请求下继续发送 cookie, 不区分大小写。</li><li><code>Strict</code>: 浏览器将只在访问相同站点时发送cookie</li><li><code>Lax</code>: 用户从外部站点导航至URL。新版本浏览器中，为默认选项。将会为一些跨站子请求保留，如图片加载或者 frames 的调用，但只有当用户从外部站点导航到 URL 时才会发送。如 link 链接</li></ul></li></ul></li></ul><h2 id="localstorage" tabindex="-1"><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Window/localStorage" target="_blank" rel="noopener noreferrer">localStorage</a></h2><blockquote><p>存储容量，不同的浏览器大小不一，大概在 5M 左右。</p></blockquote><h3 id="特点" tabindex="-1">特点</h3><ul><li>运行访问一个<code>Document</code>源的对象<code>Storage</code>。</li><li>同一个域的数据可以共享。</li><li>存储在<code>localStorage</code>的数据可以长期保留。</li><li>手动清除、调用<code>api</code>清除、卸载浏览器才能清除<code>localStorage</code>的数据。</li><li>采用key-value 方式存储值。 键值如果不是字符串类型，就会被转化为字符串类型。</li><li>不同的<code>tabs</code>的相同 url，访问相同的<code>localStorage</code>源。而<code>sessionStorage</code>则会创建不同的<code>sessionStorage</code>源，互相隔离。</li><li><code>localStorage</code> 遵循页面协议，即：<code>http:</code> 和 <code>https:</code> 分别创建不同的<code>localStorage</code></li></ul><h3 id="api" tabindex="-1">Api</h3><div class="language-js line-numbers-mode"><pre><code><span class="token comment">// 存储</span>
localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">&#39;key&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;value&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 获取值</span>
<span class="token keyword">let</span> data <span class="token operator">=</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">&#39;key&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 移除指定 key 的数据</span>
localStorage<span class="token punctuation">.</span><span class="token function">removeItem</span><span class="token punctuation">(</span><span class="token string">&#39;key&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 清空 localStorage</span>
localStorage<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="sessionstorage" tabindex="-1"><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Window/sessionStorage" target="_blank" rel="noopener noreferrer">sessionStorage</a></h2><blockquote><p>允许访问一个对应当前源的 session <code>storage</code>对象。 存储在 sessionStorage 里面的数据在页面会话结束时会被清除。 <code>sessionStorage</code> 是临时存储。 存储容量，不同的浏览器大小不一，大概在 5M 左右。</p></blockquote><h3 id="特点-1" tabindex="-1">特点</h3><ul><li>页面会话在浏览器打开期间一直保持，并且重新加载或恢复页面仍然保持原来的页面会 (此时数据不会被删除)</li><li>在新标签或窗口打开一个页面时会复制顶级浏览器会话的上下文作为新会话的上下文。(还没完全理解，可能是同一个窗口跳转相同 url 的不同页面)</li><li>打开多个相同的<code>URL</code>的 Tabs 页面，会创建各自的 <code>sessionStorage</code></li><li>关闭对应浏览器标签或窗口，会清除对应的 <code>sessionStorage</code></li><li>不会的协议会创建不同的 <code>sessionStorage</code> 例如：<code>http://example.com</code>与<code>https://example.com</code>，就会创建不同的<code>sessionStorage</code>，相互隔离。</li><li>键值总是会以<code>UTF-16 DOMString</code>的格式存储，键值的不同类型都会转化为字符串类型</li></ul><h3 id="api-1" tabindex="-1">Api</h3><div class="language-js line-numbers-mode"><pre><code><span class="token comment">// 保存数据到 sessionStorage</span>
sessionStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">&#39;key&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;value&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 从sessionStorage 获取数据</span>
<span class="token keyword">let</span> data <span class="token operator">=</span> sessionStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">&#39;key&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 从sessionStorage 删除保存的数据</span>
sessionStorage<span class="token punctuation">.</span><span class="token function">removeItem</span><span class="token punctuation">(</span><span class="token string">&#39;key&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 从sessionStorage 删除所有保存的数据</span>
sessionStorage<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="indexdb" tabindex="-1">indexDB</h2><ul><li>indexDB 是一种底层API, 用于在客户端存储大量的结构化数据。</li><li>大小 无限 (硬盘大小限制)<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/IndexedDB_API/Browser_storage_limits_and_eviction_criteria" target="_blank" rel="noopener noreferrer">IndexedDB 浏览器存储限制和清理标准</a></li><li>同一个域下数据共享。(不包含子域)</li></ul><h3 id="现成的类库" tabindex="-1">现成的类库</h3><ul><li><a href="https://localforage.docschina.org/" target="_blank" rel="noopener noreferrer">localForage</a>：一个简单的 Polyfill，提供了简单的客户端数据存储的值语法。它在后台使用 IndexedDB，并在不支持 IndexedDB 的浏览器中回退到 WebSQL 或 localStorage。</li><li><a href="https://dexie.org/" target="_blank" rel="noopener noreferrer">Dexie.js</a>：IndexedDB 的包装，通过简单的语法，可以更快地进行代码开发。</li><li><a href="https://github.com/erikolson186/zangodb" target="_blank" rel="noopener noreferrer">ZangoDB</a>：类似 MongoDB 的 IndexedDB 接口，支持 MongoDB 的大多数熟悉的过滤、投影、排序、更新和聚合功能。</li><li><a href="https://jsstore.net/" target="_blank" rel="noopener noreferrer">JsStore</a>：一个带有 SQL 语法的 IndexedDB 包装器。</li><li><a href="https://github.com/mWater/minimongo" target="_blank" rel="noopener noreferrer">MiniMongo</a>：由 localstorage 支持的客户端内存中的 mongodb，通过 http 进行服务器同步。MeteorJS 使用 MiniMongo。</li><li><a href="https://pouchdb.com/" target="_blank" rel="noopener noreferrer">PouchDB</a>：使用 IndexedDB 在浏览器中实现 CouchDB 的客户端。</li><li><a href="https://www.npmjs.com/package/idb" target="_blank" rel="noopener noreferrer">idb</a>：一个微小的（〜1.15k）库，大多 API 与 IndexedDB 类似，但做了一些小的改进，让数据库的可用性得到了大大的提升。</li><li><a href="https://www.npmjs.com/package/idb-keyval" target="_blank" rel="noopener noreferrer">idb-keyval</a>：使用 IndexedDB 实现的超级简单且小巧的（~600B）基于 Promise 的键值对存储。</li><li><a href="https://www.npmjs.com/package/@sifrr/storage" target="_blank" rel="noopener noreferrer">sifrr-storage</a>：一个非常小的（~2kB）基于 Promise 的客户端键值数据库。基于 IndexedDB、localStorage、WebSQL 和 Cookies 实现。它可以自动选择上述支持的数据库，并按照优先顺序使用。</li><li><a href="https://github.com/google/lovefield" target="_blank" rel="noopener noreferrer">lovefield</a>：Lovefield 是一个用于 Web App 的关系型数据库，使用 JavaScript 编写，可以在不同的浏览器环境中运行，提供了类似 SQL 的 API，速度快、安全且易用。</li></ul></div></div><footer class="page-footer" data-v-7eddb2c4 data-v-07c132fc><div class="edit" data-v-07c132fc><div class="edit-link" data-v-07c132fc data-v-1ed99556><!----></div></div><div class="updated" data-v-07c132fc><p class="last-updated" data-v-07c132fc data-v-abce3432><span class="prefix" data-v-abce3432>最后更新:</span><span class="datetime" data-v-abce3432></span></p></div></footer><div class="next-and-prev-link" data-v-7eddb2c4 data-v-38ede35f><div class="container" data-v-38ede35f><div class="prev" data-v-38ede35f><a class="link" href="/books/n-01-前端笔记/s-01-JS/04-js进入全屏和退出全屏" data-v-38ede35f><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon icon-prev" data-v-38ede35f><path d="M19,11H7.4l5.3-5.3c0.4-0.4,0.4-1,0-1.4s-1-0.4-1.4,0l-7,7c-0.1,0.1-0.2,0.2-0.2,0.3c-0.1,0.2-0.1,0.5,0,0.8c0.1,0.1,0.1,0.2,0.2,0.3l7,7c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3c0.4-0.4,0.4-1,0-1.4L7.4,13H19c0.6,0,1-0.4,1-1S19.6,11,19,11z"></path></svg><span class="text" data-v-38ede35f>js进入全屏和退出全屏</span></a></div><div class="next" data-v-38ede35f><a class="link" href="/books/n-01-前端笔记/s-03-vite/01-vite vue 添加代码格式化、审查、git提交" data-v-38ede35f><span class="text" data-v-38ede35f>vite vue 添加代码格式化、审查、git提交</span><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon icon-next" data-v-38ede35f><path d="M19.9,12.4c0.1-0.2,0.1-0.5,0-0.8c-0.1-0.1-0.1-0.2-0.2-0.3l-7-7c-0.4-0.4-1-0.4-1.4,0s-0.4,1,0,1.4l5.3,5.3H5c-0.6,0-1,0.4-1,1s0.4,1,1,1h11.6l-5.3,5.3c-0.4,0.4-0.4,1,0,1.4c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3l7-7C19.8,12.6,19.9,12.5,19.9,12.4z"></path></svg></a></div></div></div><!--[--><!--]--></div></main></div><!----><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"books_n-01-前端笔记_c-s-05-three.js_01-three.js基本知识.md\":\"d52a837d\",\"books_n-01-前端笔记_c-s-05-three.js_05-three.js插件.md\":\"ec2b4deb\",\"books_n-01-前端笔记_index.md\":\"a9ad3b4d\",\"books_n-01-前端笔记_s-01-js_01-js数据类型.md\":\"2bc91c46\",\"books_n-01-前端笔记_s-01-js_02-类型判断.md\":\"734d459e\",\"books_n-01-前端笔记_s-01-js_03-变量提升和函数提升.md\":\"0ab6ddbb\",\"books_n-01-前端笔记_s-01-js_04-js进入全屏和退出全屏.md\":\"25b51923\",\"books_n-01-前端笔记_s-02-浏览器_01-cookies、session、localstorage.md\":\"2e1b206c\",\"books_n-01-前端笔记_s-03-vite_01-vite vue 添加代码格式化、审查、git提交.md\":\"1ea1994c\",\"books_n-01-前端笔记_s-03-vite_02-vite添加路径别名.md\":\"eeaacdc2\",\"books_n-01-前端笔记_s-04-css_01-暗黑模式切换.md\":\"9efc23c3\",\"books_n-01-前端笔记_s-04-css_index.md\":\"480a9e01\",\"books_n-01-前端笔记_s-05-uniapp_01-微信小程序动态获取页面title.md\":\"20d0387d\",\"books_n-02-后端_index.md\":\"1fa83a50\",\"books_n-02-后端_s-01-mysql_01-docker安装mysql.md\":\"ddba1969\",\"books_n-03-杂记_01-正则表达式汇总.md\":\"8bcf0a75\",\"books_n-03-杂记_02-git使用.md\":\"00e77d0b\",\"books_n-03-杂记_03-github的workflow.md\":\"15756a1a\",\"books_n-03-杂记_index.md\":\"ca0ae951\",\"books_n-04-插件_index.md\":\"1a7987e3\",\"index.md\":\"b5abc47b\"}")</script>
    <script type="module" async src="/assets/app.32bb6aff.js"></script>
    
  </body>
</html>